(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{7276:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(6993)}])},6993:(e,s,t)=>{"use strict";t.r(s),t.d(s,{__N_SSG:()=>r,default:()=>i});var a=t(4848),l=t(6540);let n=(0,t(5183).UU)("https://cvuxajqjvuulvgityqdg.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN2dXhhanFqdnV1bHZnaXR5cWRnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzczNjYzOTUsImV4cCI6MjA1Mjk0MjM5NX0.BNZ12THDXPyLmbDjcGBtbcDkJPxCOFlBiM1p7lZQ9FM");var r=!0;function i(e){let{posts:s}=e,[t,r]=(0,l.useState)(s.map(e=>({id:e.id,count:e.likes||0}))),[i,c]=(0,l.useState)(!1),[d,o]=(0,l.useState)({username:"",recipient:"",title:"",content:""}),[m,u]=(0,l.useState)([]),[x,h]=(0,l.useState)(null),[b,p]=(0,l.useState)(!1),[j,g]=(0,l.useState)(""),N=async e=>{let s=t.map(s=>s.id===e?{...s,count:s.count+1}:s);r(s),await n.from("posts").update({likes:s.find(s=>s.id===e).count}).eq("id",e)},y=async e=>{e.preventDefault(),await n.from("posts").insert([d]),c(!1),window.location.reload()},v=async e=>{h(e);let{data:s}=await n.from("comments").select("*").eq("post_id",e);u(s||[]),p(!0)},w=async()=>{if(j.trim()){let e=d.username.trim()||"Anonymous",s={post_id:x,content:j.trim(),username:e};await n.from("comments").insert([s]),u([...m,s]),g(""),o({...d,username:""})}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100 py-8",children:[(0,a.jsxs)("div",{className:"max-w-4xl mx-auto p-4 bg-white shadow rounded",children:[(0,a.jsxs)("header",{className:"flex justify-between items-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Keluh Kesah"}),(0,a.jsx)("button",{onClick:()=>c(!0),className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Tambah Keluhan"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:s.map(e=>{var s;return(0,a.jsxs)("div",{className:"bg-yellow-200 p-4 rounded shadow hover:shadow-lg transition",style:{transform:"rotate(-1deg)"},children:[(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:["Dari: ",e.username||"Anonim"]})}),(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:["Untuk: ",e.recipient||"Semua"]})}),(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-800 mb-2",children:e.title}),(0,a.jsx)("p",{className:"text-gray-700",children:e.content}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,a.jsxs)("button",{onClick:()=>N(e.id),className:"flex items-center text-gray-500 hover:text-gray-700",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{d:"M3.172 10H7V2a1 1 0 012 0v8h4.828a2 2 0 011.414 3.414l-5.243 5.242a1 1 0 01-1.414 0l-5.242-5.242A2 2 0 013.172 10z"})}),(null===(s=t.find(s=>s.id===e.id))||void 0===s?void 0:s.count)||0]}),(0,a.jsx)("button",{onClick:()=>v(e.id),className:"text-blue-500 hover:underline",children:"Comments"})]})]},e.id)})})]}),i&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded shadow-md w-full max-w-md",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Tambah Keluhan"}),(0,a.jsxs)("form",{onSubmit:y,children:[(0,a.jsxs)("label",{className:"block mb-2",children:["Dari (opsional):",(0,a.jsx)("input",{type:"text",className:"w-full border rounded p-2",value:d.username,onChange:e=>o({...d,username:e.target.value})})]}),(0,a.jsxs)("label",{className:"block mb-2",children:["Untuk:",(0,a.jsx)("input",{type:"text",className:"w-full border rounded p-2",value:d.recipient,onChange:e=>o({...d,recipient:e.target.value})})]}),(0,a.jsxs)("label",{className:"block mb-2",children:["Judul:",(0,a.jsx)("input",{type:"text",className:"w-full border rounded p-2",value:d.title,onChange:e=>o({...d,title:e.target.value}),required:!0})]}),(0,a.jsxs)("label",{className:"block mb-4",children:["Isi Keluhan:",(0,a.jsx)("textarea",{className:"w-full border rounded p-2",rows:"4",value:d.content,onChange:e=>o({...d,content:e.target.value}),required:!0})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("button",{type:"button",className:"bg-gray-300 text-gray-700 px-4 py-2 rounded",onClick:()=>c(!1),children:"Batal"}),(0,a.jsx)("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Tambahkan"})]})]})]})}),b&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded shadow-md w-full max-w-md",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Comments"}),(0,a.jsx)("div",{className:"mb-4 max-h-64 overflow-y-auto",children:m.length>0?m.map((e,s)=>(0,a.jsxs)("div",{className:"border-b border-gray-200 py-2 text-gray-700",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["From: ",e.username||"Anonymous"]}),(0,a.jsx)("p",{children:e.content})]},s)):(0,a.jsx)("p",{className:"text-gray-500",children:"No comments yet."})}),(0,a.jsxs)("label",{className:"block mb-2",children:["Your Name (optional):",(0,a.jsx)("input",{type:"text",className:"w-full border rounded p-2",value:d.username,onChange:e=>o({...d,username:e.target.value}),placeholder:"Enter your name or leave blank for Anonymous"})]}),(0,a.jsxs)("label",{className:"block mb-2",children:["Add a Comment:",(0,a.jsx)("textarea",{className:"w-full border rounded p-2",rows:"3",value:j,onChange:e=>g(e.target.value),placeholder:"Write your comment..."})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("button",{type:"button",className:"bg-gray-300 text-gray-700 px-4 py-2 rounded",onClick:()=>p(!1),children:"Close"}),(0,a.jsx)("button",{type:"button",className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",onClick:w,children:"Add Comment"})]})]})})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[183,636,593,792],()=>s(7276)),_N_E=e.O()}]);