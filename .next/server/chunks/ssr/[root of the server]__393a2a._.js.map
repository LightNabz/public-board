{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///home/dasnabz/public-board/pages/index.js"],"sourcesContent":["import { useState } from \"react\";\nimport { createClient } from \"@supabase/supabase-js\";\nimport '../styles/globals.css';\n\nconst supabase = createClient(\n  process.env.NEXT_PUBLIC_SUPABASE_URL,\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\n);\n\nexport async function getStaticProps() {\n  const { data: posts } = await supabase\n    .from(\"posts\")\n    .select(\"*\")\n    .order(\"created_at\", { ascending: false });\n\n  return { props: { posts } };\n}\n\nexport default function Home({ posts }) {\n  const [likes, setLikes] = useState(\n    posts.map((post) => ({ id: post.id, count: post.likes || 0 }))\n  );\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [formData, setFormData] = useState({ username: \"\", recipient: \"\", title: \"\", content: \"\" });\n  const [comments, setComments] = useState([]);\n  const [currentPostId, setCurrentPostId] = useState(null);\n  const [isCommentsModalOpen, setIsCommentsModalOpen] = useState(false);\n  const [newComment, setNewComment] = useState(\"\");\n\n  const handleLike = async (id) => {\n    const updatedLikes = likes.map((like) =>\n      like.id === id ? { ...like, count: like.count + 1 } : like\n    );\n    setLikes(updatedLikes);\n\n    await supabase\n      .from(\"posts\")\n      .update({ likes: updatedLikes.find((like) => like.id === id).count })\n      .eq(\"id\", id);\n  };\n\n  const handleFormSubmit = async (e) => {\n    e.preventDefault();\n    await supabase.from(\"posts\").insert([formData]);\n    setIsModalOpen(false);\n    window.location.reload(); // Refresh to show the new post\n  };\n\n  const openCommentsModal = async (postId) => {\n    setCurrentPostId(postId);\n    const { data: postComments } = await supabase\n      .from(\"comments\")\n      .select(\"*\")\n      .eq(\"post_id\", postId);\n    setComments(postComments || []);\n    setIsCommentsModalOpen(true);\n  };\n\n  const handleAddComment = async () => {\n    if (newComment.trim()) {\n      const username = formData.username.trim() || \"Anonymous\"; // Default to \"Anonymous\" if empty\n      const newCommentData = { \n        post_id: currentPostId, \n        content: newComment.trim(), \n        username \n      };\n  \n      await supabase.from(\"comments\").insert([newCommentData]);\n  \n      const updatedComments = [...comments, newCommentData];\n      setComments(updatedComments);\n      setNewComment(\"\");\n      setFormData({ ...formData, username: \"\" }); // Reset username field after submission\n    }\n  };  \n\n  return (\n    <div className=\"min-h-screen bg-gray-100 py-8\">\n      <div className=\"max-w-4xl mx-auto p-4 bg-white shadow rounded\">\n        <header className=\"flex justify-between items-center mb-8\">\n          <h1 className=\"text-3xl font-bold text-gray-800\">Keluh Kesah</h1>\n          <button\n            onClick={() => setIsModalOpen(true)}\n            className=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\"\n          >\n            Tambah Keluhan\n          </button>\n        </header>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          {posts.map((post) => (\n            <div\n              key={post.id}\n              className=\"bg-yellow-200 p-4 rounded shadow hover:shadow-lg transition\"\n              style={{ transform: \"rotate(-1deg)\" }}\n            >\n              <div className=\"mb-2\">\n                <span className=\"text-sm text-gray-700\">\n                  Dari: {post.username || \"Anonim\"}\n                </span>\n              </div>\n              <div className=\"mb-2\">\n                <span className=\"text-sm text-gray-700\">\n                  Untuk: {post.recipient || \"Semua\"}\n                </span>\n              </div>\n              <h2 className=\"text-lg font-medium text-gray-800 mb-2\">\n                {post.title}\n              </h2>\n              <p className=\"text-gray-700\">{post.content}</p>\n              <div className=\"flex items-center justify-between mt-4\">\n                <button\n                  onClick={() => handleLike(post.id)}\n                  className=\"flex items-center text-gray-500 hover:text-gray-700\"\n                >\n                  <svg\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    className=\"h-5 w-5 mr-1\"\n                    viewBox=\"0 0 20 20\"\n                    fill=\"currentColor\"\n                  >\n                    <path d=\"M3.172 10H7V2a1 1 0 012 0v8h4.828a2 2 0 011.414 3.414l-5.243 5.242a1 1 0 01-1.414 0l-5.242-5.242A2 2 0 013.172 10z\" />\n                  </svg>\n                  {likes.find((like) => like.id === post.id)?.count || 0}\n                </button>\n                <button\n                  onClick={() => openCommentsModal(post.id)}\n                  className=\"text-blue-500 hover:underline\"\n                >\n                  Comments\n                </button>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Modal for Adding Posts */}\n      {isModalOpen && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10\">\n          <div className=\"bg-white p-6 rounded shadow-md w-full max-w-md\">\n            <h2 className=\"text-xl font-bold mb-4\">Tambah Keluhan</h2>\n            <form onSubmit={handleFormSubmit}>\n              <label className=\"block mb-2\">\n                Dari (opsional):\n                <input\n                  type=\"text\"\n                  className=\"w-full border rounded p-2\"\n                  value={formData.username}\n                  onChange={(e) => setFormData({ ...formData, username: e.target.value })}\n                />\n              </label>\n              <label className=\"block mb-2\">\n                Untuk:\n                <input\n                  type=\"text\"\n                  className=\"w-full border rounded p-2\"\n                  value={formData.recipient}\n                  onChange={(e) => setFormData({ ...formData, recipient: e.target.value })}\n                />\n              </label>\n              <label className=\"block mb-2\">\n                Judul:\n                <input\n                  type=\"text\"\n                  className=\"w-full border rounded p-2\"\n                  value={formData.title}\n                  onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                  required\n                />\n              </label>\n              <label className=\"block mb-4\">\n                Isi Keluhan:\n                <textarea\n                  className=\"w-full border rounded p-2\"\n                  rows=\"4\"\n                  value={formData.content}\n                  onChange={(e) => setFormData({ ...formData, content: e.target.value })}\n                  required\n                ></textarea>\n              </label>\n              <div className=\"flex justify-between\">\n                <button\n                  type=\"button\"\n                  className=\"bg-gray-300 text-gray-700 px-4 py-2 rounded\"\n                  onClick={() => setIsModalOpen(false)}\n                >\n                  Batal\n                </button>\n                <button\n                  type=\"submit\"\n                  className=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\"\n                >\n                  Tambahkan\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n\n      {/* Modal for Comments */}\n      {isCommentsModalOpen && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10\">\n            <div className=\"bg-white p-6 rounded shadow-md w-full max-w-md\">\n            <h2 className=\"text-xl font-bold mb-4\">Comments</h2>\n            <div className=\"mb-4 max-h-64 overflow-y-auto\">\n                {comments.length > 0 ? (\n                comments.map((comment, index) => (\n                    <div\n                    key={index}\n                    className=\"border-b border-gray-200 py-2 text-gray-700\"\n                    >\n                    <span className=\"text-sm text-gray-600\">\n                        From: {comment.username || \"Anonymous\"}\n                    </span>\n                    <p>{comment.content}</p>\n                    </div>\n                ))\n                ) : (\n                <p className=\"text-gray-500\">No comments yet.</p>\n                )}\n            </div>\n\n            {/* Input for Comment Username */}\n            <label className=\"block mb-2\">\n                Your Name (optional):\n                <input\n                type=\"text\"\n                className=\"w-full border rounded p-2\"\n                value={formData.username}\n                onChange={(e) => setFormData({ ...formData, username: e.target.value })}\n                placeholder=\"Enter your name or leave blank for Anonymous\"\n                />\n            </label>\n\n            {/* Input for New Comment */}\n            <label className=\"block mb-2\">\n                Add a Comment:\n                <textarea\n                className=\"w-full border rounded p-2\"\n                rows=\"3\"\n                value={newComment}\n                onChange={(e) => setNewComment(e.target.value)}\n                placeholder=\"Write your comment...\"\n                ></textarea>\n            </label>\n\n            <div className=\"flex justify-between\">\n                <button\n                type=\"button\"\n                className=\"bg-gray-300 text-gray-700 px-4 py-2 rounded\"\n                onClick={() => setIsCommentsModalOpen(false)}\n                >\n                Close\n                </button>\n                <button\n                type=\"button\"\n                className=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\"\n                onClick={handleAddComment}\n                >\n                Add Comment\n                </button>\n            </div>\n            </div>\n        </div>\n        )}\n\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 604, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}